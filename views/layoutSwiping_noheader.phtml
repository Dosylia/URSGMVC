<?php
    if (!isset($page_css) || !is_array($page_css)) {
        $page_css = [];
    }
    array_unshift($page_css, 'layout_swiping');
    require "views/layout.phtml"; 
?>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P3XDDBJQ"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<?php if (isset($_SESSION['mode'])) : ?>
    <body class="<?= ($_SESSION['mode'] === 'dark') ? 'dark-mode' : '' ?>">
<?php else : ?>
    <body>
<?php endif; ?>

<header>
    <nav>
        <div class="nav_swiping">
            <a href="/"><img title="Home" class="scale" src="public/images/favicon/android-chrome-512x512.png" alt="logo_ursg"></a>
            <div class="nav-swiping-row">
                <a href="/playerfinder"><img title="Player Finder" class="scaleNoRound" src="public/images/playerfinder.png" alt="swipe"></a>
                <a href="/?triggerSignUp=true" class="swiping_noheader_signup">Sign up</a>
                <div class="toggle-container">
                    <div title="Dark mode" id="toggle-button" class="toggle-button"></div>
                </div>
            </div>
        </div>
    </nav>
</header>
    <main>
        <?php if(isset($_GET['message'])) :?>
            <span class="form-error"><?= $_GET['message'] ?></span>
        <?php endif; ?>
        <?php require $template.".phtml"; ?> 
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-group">
                <div class="footer-links">
                    <p><?= $this->_('footer_links') ?></p>
                    <nav class="footer-nav-links">
                        <a href="/legalNotice"><?= $this->_('legal_notice_privacy_policy') ?></a>
                        <a href="/termsOfService"><?= $this->_('tos') ?></a>
                        <a href="/CSAE"><?= $this->_('csae') ?></a>
                    </nav>
                </div>

                <div class="footer-socials">
                    <p><?= $this->_('footer_socials') ?></p>
                    <nav class="footer-nav-socials">
                        <a href="https://twitter.com/MeetURSG" target="_blank" aria-label="<?= $this->_('social_link_aria_twitter') ?>"><i class="fa-brands fa-twitter"></i></a>
                        <a href="https://discord.gg/Bfpkws74V3" target="_blank" aria-label="<?= $this->_('social_link_aria_discord') ?>"><i class="fa-brands fa-discord"></i></a>
                        <a href="https://www.reddit.com/r/URSG/" target="_blank" aria-label="<?= $this->_('social_link_aria_reddit') ?>"><i class="fa-brands fa-reddit-alien"></i></a>
                    </nav>
                </div>
            </div>

            <div class="footer-group">
                <div class="footer-creators">
                    <p><?= $this->_('footer_madeby') ?></p>
                    <nav class="footer-nav-creators">
                        <a href="https://twitter.com/Dosylia" target="_blank" aria-label="<?= $this->_('social_link_aria_dosylia') ?>">Dosylia</a>
                    </nav>
                </div>

                <div class="footer-languages">
                    <p><?= $this->_('footer_language') ?></p>
                    <form method="POST" action="/changeLanguage" class="language-switcher">
                        <label for="lang">üåê</label>
                        <select name="lang" id="lang" onchange="this.form.submit()">
                            <option value="en" <?= ($_SESSION['lang'] ?? 'en') === 'en' ? 'selected' : '' ?>>EN</option>
                            <option value="fr" <?= ($_SESSION['lang'] ?? 'en') === 'fr' ? 'selected' : '' ?>>FR</option>
                            <option value="de" <?= ($_SESSION['lang'] ?? 'en') === 'de' ? 'selected' : '' ?>>DE</option>
                            <option value="es" <?= ($_SESSION['lang'] ?? 'en') === 'es' ? 'selected' : '' ?>>ES</option>
                        </select>
                    </form>
                </div>
            </div>
        </div>

        <div class="footer-copyright">
            <p>&copy; <?= date('Y') ?> <?= $this->_('footer_copyright') ?></p>
            <p class="legal"><?= $this->_('footer_riot') ?></p>
        </div>
    </footer>

    <!-- Triggers for tracking scritps -->
    <script>
        window.addEventListener('DOMContentLoaded', function () {
            // Send page view event
            if (typeof sendPageView === 'function') {
                sendPageView('swiping_page');
            }
            // Check if user is returning and send event
            if (typeof sendReturningUserEvent === 'function') {
                sendReturningUserEvent();
            }
        });
     </script>

</body>

</html>